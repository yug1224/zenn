---
title: 'Voltaã§ã‚‚.node-versionã‚„.nvmrcã‚’ä½¿ã£ã¦Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆãŒã—ãŸã„ï¼'
emoji: 'âš¡'
type: 'tech' # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ['nodejs', 'volta', 'zsh']
published: true
published_at: 2023-08-29 03:00
publication_name: 'hrbrain'
---

## ã¯ã˜ã‚ã«

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•ã‚’ã™ã‚‹ã¨Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è‡ªå‹•ã§åˆ‡ã‚Šæ›¿ãˆã¦ãã‚Œã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã®å­˜åœ¨ã£ã¦å¬‰ã—ã„ã§ã™ã‚ˆã­ã€‚

ç§ã¯Rustè£½ã®[Volta](https://volta.sh/)ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã§ã™ãŒâ€¦â€¦

ã€ŒVoltaã§ã‚‚`.node-version`ã‚„`.nvmrc`ã‚’ä½¿ã£ã¦Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆãŒã—ãŸã„ï¼ã€

ã€Œã§ã‚‚ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã¯Voltaã‚’ä½¿ã£ã¦ã„ãªã„ã®ã§`package.json`ã‚’æ±šæŸ“ã™ã‚‹ã®ã¯ã„ã‚„ã ï¼ã€

ãã†æ€ã£ãŸã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ

https://github.com/volta-cli/volta/issues/282

https://github.com/volta-cli/volta/issues/983

ã—ã‹ã—ã€ä»¥å‰ã‹ã‚‰Issueã«ä¸ŠãŒã£ã¦ã„ã‚‹é€šã‚Šã€æ®‹å¿µãªãŒã‚‰Voltaã§ã¯`.node-version`ã‚’ä½¿ã£ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚

å¯¾å¿œã—ã¦ã„ãªã„ãªã‚‰è‡ªåˆ†ã§å¯¾å¿œã—ã¦ã—ã¾ãˆï¼ï¼ğŸ‘Š

ã¨ã„ã†ã“ã¨ã§ã€`chpwd`ã‚’ä½¿ã£ã¦`.node-version`ã‚„`.nvmrc`ãŒã‚ã‚Œã°ã€Voltaã§ã‚‚Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒåˆ‡ã‚Šæ›¿ã‚ã‚‹ã‚ˆã†ã«ã—ã¦ã¿ã¾ã—ãŸã€‚

## chpwdã‚’ä½¿ã£ã¦.node-versionã‚„.nvmrcã‚’èª­ã¿è¾¼ã‚€

ã§ãã‚ãŒã£ãŸã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚è‡ªèº«ã®`.zshrc`ã«è¿½è¨˜ã—ã¦ã¿ã¦ãã ã•ã„ã€‚

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•ã‚’ãƒ•ãƒƒã‚¯ã—ã¦å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹zshã®`chpwd`ã‚’åˆ©ç”¨ã—ã€`.node-version`ã‚„`.nvmrc`ã®è¨­å®šå€¤ã«å¿œã˜ã¦ã€`volta install`ã®å®Ÿè¡Œã®ä»•æ–¹ã‚’èª¿æ•´ã—ã¦ã„ã¾ã™ã€‚

```sh:.zshrc
autoload -Uz add-zsh-hook
function chpwd_volta_install() {
  # .node-versionãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
  if [[ -e ".node-version" ]]; then
    # .node-versionã‹ã‚‰å†…å®¹ã‚’èª­ã¿å–ã‚‹
    content=$(cat .node-version)
    volta install node@$content --quiet
  fi

  # .nvmrcãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
  if [[ -e ".nvmrc" ]]; then
    # .nvmrcã‹ã‚‰å†…å®¹ã‚’èª­ã¿å–ã‚‹
    content=$(cat .nvmrc)

    case $content in
    # lts/argonã®å ´åˆ
    "lts/argon")
      volta install node@4 --quiet
      ;;
    # lts/boronã®å ´åˆ
    "lts/boron")
      volta install node@6 --quiet
      ;;
    # lts/carbonã®å ´åˆ
    "lts/carbon")
      volta install node@8 --quiet
      ;;
    # lts/dubniumã®å ´åˆ
    "lts/dubnium")
      volta install node@10 --quiet
      ;;
    # lts/erbiumã®å ´åˆ
    "lts/erbium")
      volta install node@12 --quiet
      ;;
    # lts/fermiumã®å ´åˆ
    "lts/fermium")
      volta install node@14 --quiet
      ;;
    # lts/galliumã®å ´åˆ
    "lts/gallium")
      volta install node@16 --quiet
      ;;
    # lts/hydrogenã®å ´åˆ
    "lts/hydrogen")
      volta install node@18 --quiet
      ;;
    # lts/*ã®å ´åˆ
    "lts/*")
      volta install node@lts --quiet
      ;;
    # latest,current,node,*ã®å ´åˆ
    "latest" | "current" | "node" | "*")
      volta install node@latest --quiet
      ;;
    # ãã‚Œä»¥å¤–ã®å ´åˆ
    *)
      volta install node@$content --quiet
      ;;
    esac
  fi
}
add-zsh-hook chpwd chpwd_volta_install
```

`.node-version`ã¯è‰¯ã„ã®ã§ã™ãŒã€`.nvmrc`ã¯ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä»¥å¤–ã«ã‚‚LTSã‚³ãƒ¼ãƒ‰ãƒãƒ¼ãƒ ã«ã‚ˆã‚‹æŒ‡å®šæ–¹æ³•ãŒã‚ã£ãŸã‚Šã—ãŸã®ã§ã€æ„å¤–ã¨å„ä»‹ã§ã—ãŸã­â€¦â€¦

ä»–ã«ã‚‚æ¡ä»¶ãŒã‚ã‚Šãã†ãªæ°—ã‚‚ã—ã¾ã™ãŒã€ã—ã°ã‚‰ãã“ã‚Œã§é‹ç”¨ã—ã¦ã¿ã‚ˆã†ã¨æ€ã£ã¦ã„ã¾ã™ã€‚

![ramenãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨sushiãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨tempuraãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç§»å‹•ã—ã¦ã„ã‚‹ã¨ã“ã‚](/images/989acf69368896/ramen-sushi-tempura.gif)

`.node-version`ã¨`.nvmrc`ã¨`package.json`ãŒã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé–“ã‚’å®Ÿéš›ã«ç§»å‹•ã¿ã‚‹ã¨ã“ã‚“ãªæ„Ÿã˜ã€‚

ãƒãƒƒãƒãƒªã£ã™ã­ğŸ‘

## å‚è€ƒ

ä¸‹è¨˜ã®è¨˜äº‹ã‚’å‚è€ƒã«ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸï¼ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼

https://github.com/actions/setup-node

https://github.com/shadowspawn/node-version-usage

https://github.com/nvm-sh/nvm/blob/master/nvm.sh

https://zsh.sourceforge.io/Doc/Release/Functions.html

https://nodejs.org/ja/download/releases
