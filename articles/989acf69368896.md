---
title: 'Voltaã§ã‚‚.node-versionã‚„.nvmrcã‚’ä½¿ã£ã¦Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆãŒã—ãŸã„ï¼'
emoji: 'âš¡'
type: 'tech' # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ['nodejs', 'volta', 'zsh']
published: true
published_at: 2023-08-29 03:00
publication_name: 'hrbrain'
---

## ã¯ã˜ã‚ã«

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•ã‚’ã™ã‚‹ã¨Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è‡ªå‹•ã§åˆ‡ã‚Šæ›¿ãˆã¦ãã‚Œã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã®å­˜åœ¨ã£ã¦å¬‰ã—ã„ã§ã™ã‚ˆã­ã€‚

ç§ã¯Rustè£½ã®[Volta](https://volta.sh/)ã‚’ä½¿ã£ã¦ã„ã¾ã™ãŒã€Voltaã§ã‚‚`.node-version`ã‚„`.nvmrc`ã‚’ä½¿ã£ã¦Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆãŒã—ãŸã„ï¼

ãã†æ€ã£ãŸã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ

https://github.com/volta-cli/volta/issues/282

https://github.com/volta-cli/volta/issues/983

ã—ã‹ã—ã€ä»¥å‰ã‹ã‚‰Issueã«ä¸ŠãŒã£ã¦ã„ã‚‹é€šã‚Šã€æ®‹å¿µãªãŒã‚‰Voltaã§ã¯`.node-version`ã‚’ä½¿ã£ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚

å¯¾å¿œã—ã¦ã„ãªã„ãªã‚‰è‡ªåˆ†ã§å¯¾å¿œã—ã¦ã—ã¾ãˆï¼ï¼ğŸ‘Š

ã¨ã„ã†ã“ã¨ã§ã€`chpwd()`ã‚’ä½¿ã£ã¦`.node-version`ã‚„`.nvmrc`ãŒã‚ã‚Œã°ã€Voltaã§ã‚‚Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒåˆ‡ã‚Šæ›¿ã‚ã‚‹ã‚ˆã†ã«ã—ã¦ã¿ã¾ã—ãŸã€‚

## chpwd()ã‚’ä½¿ã£ã¦.node-versionã‚„.nvmrcã‚’èª­ã¿è¾¼ã‚€

ã§ãã‚ãŒã£ãŸã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•ã‚’ãƒ•ãƒƒã‚¯ã—ã¦å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹zshã®`chpwd()`é–¢æ•°ã‚’åˆ©ç”¨ã—ã€`.node-version`ã‚„`.nvmrc`ã®è¨­å®šå€¤ã«å¿œã˜ã¦ã€`volta install`ã®å®Ÿè¡Œã®ä»•æ–¹ã‚’èª¿æ•´ã—ã¦ã„ã¾ã™ã€‚

```sh:.zshrc
chpwd() {
  # .node-versionãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
  if [[ -e ".node-version" ]]; then
    # .node-versionã‹ã‚‰å†…å®¹ã‚’èª­ã¿å–ã‚‹
    content=$(cat .node-version)
    volta install node@$content

  # .nvmrcãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
  elif [[ -e ".nvmrc" ]]; then
    # .nvmrcã‹ã‚‰å†…å®¹ã‚’èª­ã¿å–ã‚‹
    content=$(cat .nvmrc)

    # lts/argonã®å ´åˆ
    if [[ $content == "lts/argon" ]]; then
      volta install node@4
    # lts/boronã®å ´åˆ
    elif [[ $content == "lts/boron" ]]; then
      volta install node@6
    # lts/carbonã®å ´åˆ
    elif [[ $content == "lts/carbon" ]]; then
      volta install node@8
    # lts/dubniumã®å ´åˆ
    elif [[ $content == "lts/dubnium" ]]; then
      volta install node@10
    # lts/erbiumã®å ´åˆ
    elif [[ $content == "lts/erbium" ]]; then
      volta install node@12
    # lts/fermiumã®å ´åˆ
    elif [[ $content == "lts/fermium" ]]; then
      volta install node@14
    # lts/galliumã®å ´åˆ
    elif [[ $content == "lts/gallium" ]]; then
      volta install node@16
    # lts/hydrogenã®å ´åˆ
    elif [[ $content == "lts/hydrogen" ]]; then
      volta install node@18
    # lts/*ã®å ´åˆ
    elif [[ $content == "lts/*" ]]; then
      volta install node@lts
    # latest,current,node,*ã®å ´åˆ
    elif [[ $content == "latest" || $content == "current" || $content == "node" || $content == "*" ]]; then
      volta install node@latest
    else
      volta install node@$content
    fi
  fi
}
```

`.node-version`ã¯è‰¯ã„ã®ã§ã™ãŒã€`.nvmrc`ã¯ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä»¥å¤–ã«ã‚‚LTSã‚³ãƒ¼ãƒ‰ãƒãƒ¼ãƒ ã«ã‚ˆã‚‹æŒ‡å®šæ–¹æ³•ãŒã‚ã£ãŸã‚Šã—ãŸã®ã§ã€æ„å¤–ã¨å„ä»‹ã§ã—ãŸã­â€¦â€¦

ã“ã‚Œä»¥å¤–ã«ã‚‚è¨˜æ³•ãŒã‚ã‚Šãã†ãªæ°—ã‚‚ã—ã¾ã™ãŒã€ã²ã¨ã¾ãšä»Šã®ã¨ã“ã‚ã¯å‹•ã„ã¦ã„ã‚‹ã®ã§ã€ã—ã°ã‚‰ãã“ã‚Œã§é‹ç”¨ã—ã¦ã¿ã‚ˆã†ã¨æ€ã£ã¦ã„ã¾ã™ã€‚

ãŠã‚ã‚ŠğŸ™

## å‚è€ƒ

ä¸‹è¨˜ã®è¨˜äº‹ã‚’å‚è€ƒã«ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸï¼ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼

https://github.com/actions/setup-node

https://github.com/shadowspawn/node-version-usage

https://github.com/nvm-sh/nvm/blob/master/nvm.sh

https://zsh.sourceforge.io/Doc/Release/Functions.html

https://nodejs.org/ja/download/releases
